{"version":3,"sources":["../../src/plugins/MutationPlugin.js"],"names":["isValidMutation","Mutation","Object","keys","getFields","length","e","MutationPlugin","builder","hook","schema","build","newWithHooks","extend","graphql","GraphQLObjectType","inflection","name","builtin","description","wrapDescription","__origin","isRootMutation","mutation"],"mappings":";;;;;;;AAGA,SAASA,eAAT,CAAyBC,QAAzB,EAAmC;AACjC,MAAI;AACF,QAAI,CAACA,QAAL,EAAe;AACb,aAAO,KAAP;AACD;;AACD,QAAIC,MAAM,CAACC,IAAP,CAAYF,QAAQ,CAACG,SAAT,EAAZ,EAAkCC,MAAlC,KAA6C,CAAjD,EAAoD;AAClD,aAAO,KAAP;AACD;AACF,GAPD,CAOE,OAAOC,CAAP,EAAU;AACV,WAAO,KAAP;AACD;;AACD,SAAO,IAAP;AACD;;IAE8BC,c,GAAf,eAAeA,cAAf,CAA8BC,OAA9B,EAAuC;AACrDA,EAAAA,OAAO,CAACC,IAAR,CACE,eADF,EAEE,CAACC,MAAD,EAAaC,KAAb,KAAuB;AACrB,UAAM;AACJC,MAAAA,YADI;AAEJC,MAAAA,MAFI;AAGJC,MAAAA,OAAO,EAAE;AAAEC,QAAAA;AAAF,OAHL;AAIJC,MAAAA;AAJI,QAKFL,KALJ;AAMA,UAAMV,QAAQ,GAAGW,YAAY,CAC3BG,iBAD2B,EAE3B;AACEE,MAAAA,IAAI,EAAED,UAAU,CAACE,OAAX,CAAmB,UAAnB,CADR;AAEEC,MAAAA,WAAW,EAAER,KAAK,CAACS,eAAN,CACX,4EADW,EAEX,MAFW;AAFf,KAF2B,EAS3B;AACEC,MAAAA,QAAQ,EAAG,8CADb;AAEEC,MAAAA,cAAc,EAAE;AAFlB,KAT2B,EAa3B,IAb2B,CAA7B;;AAeA,QAAItB,eAAe,CAACC,QAAD,CAAnB,EAA+B;AAC7B,aAAOY,MAAM,CACXH,MADW,EAEX;AACEa,QAAAA,QAAQ,EAAEtB;AADZ,OAFW,EAKX,gCALW,CAAb;AAOD,KARD,MAQO;AACL,aAAOS,MAAP;AACD;AACF,GAnCH,EAoCE,CAAC,UAAD,CApCF,EAqCE,EArCF,EAsCE,CAAC,OAAD,CAtCF;AAwCD,C","sourcesContent":["// @flow\nimport type { Plugin } from \"../SchemaBuilder\";\n\nfunction isValidMutation(Mutation) {\n  try {\n    if (!Mutation) {\n      return false;\n    }\n    if (Object.keys(Mutation.getFields()).length === 0) {\n      return false;\n    }\n  } catch (e) {\n    return false;\n  }\n  return true;\n}\n\nexport default (async function MutationPlugin(builder) {\n  builder.hook(\n    \"GraphQLSchema\",\n    (schema: {}, build) => {\n      const {\n        newWithHooks,\n        extend,\n        graphql: { GraphQLObjectType },\n        inflection,\n      } = build;\n      const Mutation = newWithHooks(\n        GraphQLObjectType,\n        {\n          name: inflection.builtin(\"Mutation\"),\n          description: build.wrapDescription(\n            \"The root mutation type which contains root level fields which mutate data.\",\n            \"type\"\n          ),\n        },\n        {\n          __origin: `graphile-build built-in (root mutation type)`,\n          isRootMutation: true,\n        },\n        true\n      );\n      if (isValidMutation(Mutation)) {\n        return extend(\n          schema,\n          {\n            mutation: Mutation,\n          },\n          \"Adding mutation type to schema\"\n        );\n      } else {\n        return schema;\n      }\n    },\n    [\"Mutation\"],\n    [],\n    [\"Query\"]\n  );\n}: Plugin);\n"],"file":"MutationPlugin.js"}